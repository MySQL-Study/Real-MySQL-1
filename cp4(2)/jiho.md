# Chapter4 - 아키텍처 (4.2.7~끝)

### 4.2.7 InnoDB 버퍼 풀

-   디스크의 데이터 파일이나 인덱스 정보를 메모리에 캐시해두는 공간
-   쓰기 작업을 지연시켜 일괄 작업으로 처리할 수 있게 해주는 버퍼 역할도 같이 수행
    -   왜 쓰기 작업을 지연시켜야 하는가?
        -   변경된 데이터를 모아서 처리하면 랜덤한 디스크의 작업 횟수를 줄일 수 있기 때문

#### 크기 설정

-   InnoDB 버퍼 풀 크기 설정 시 고려할 사항
    -   운영체제
    -   클라이언트 스레드
    -   MySQL 서버 내에서는 특별한 경우 레코드 버퍼가 커지는 경우를 고려해야 함
-   버퍼 풀 크기 동적으로 설정하기
    -   가능하면 버퍼 풀의 크기를 적절히 작은 값으로 설정해서 조금씩 증가시키는 게 최적
    -   버퍼 풀의 크기를 증가시킬 땐 MySQL 서버가 여유로울 때 진행하기
    -   버퍼 풀의 크기를 줄이는 건 서비스 영향도가 매우 크므로 웬만해서는 X
-   버퍼 풀 인스턴스
    -   버퍼 풀을 여러 개로 쪼개서 관리 (각 버퍼 풀을 `버퍼 풀 인스턴스`라고 함)
    -   왜 쪼개서 관리하나?
        -   기존에는 버퍼 풀이 하나였는데, 이를 관리하는 잠금(세마포어) 때문에 경합(여러 스레드가 같은 자원을 사용하기 위해 대기하는 상황 -> 성능 저하)이 발생함
        -   버퍼 풀을 쪼개서 관리하면 개별 버퍼 풀 마다 잠금(세마포어)이 걸리고, 덕분에 경합을 분산시킬 수 있음
